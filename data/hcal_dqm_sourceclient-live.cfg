
process DQM = { 
	include "DQM/HcalMonitorModule/data/HcalMonitorModule.cfi"
	include "DQM/HcalMonitorClient/data/HcalMonitorClient-live.cfi"
	include "DQM/HcalMonitorModule/data/Hcal_FrontierConditions_GREN_ORCON.cff"
	include "FWCore/MessageLogger/data/MessageLogger.cfi"

	include "EventFilter/HcalRawToDigi/data/HcalRawToDigi.cfi"
        include "RecoLocalCalo/HcalRecProducers/data/HcalSimpleReconstructor-hbhe.cfi"
        include "RecoLocalCalo/HcalRecProducers/data/HcalSimpleReconstructor-ho.cfi"
        include "RecoLocalCalo/HcalRecProducers/data/HcalSimpleReconstructor-hf.cfi"

	path p = { hcalDigis, horeco, hfreco, hbhereco, hcalMonitor, hcalClient, dqmEnv, dqmSaver }

	untracked PSet options = {
		untracked vstring Rethrow = { "ProductNotFound", "TooManyProducts", "TooFewProducts" }
	}

	untracked PSet maxEvents = {untracked int32 input = -1}

      source = EventStreamHttpReader {
        string sourceURL = "http://cmsdisk1.cms:11100/urn:xdaq-application:service=storagemanager"
        int32 max_event_size = 7000000
        int32 max_queue_depth = 5
        untracked string consumerName = "HCAL DQM Consumer"
        untracked string consumerPriority = "normal"
        untracked int32 headerRetryInterval = 3
        untracked double maxEventRequestRate = 10
        untracked PSet SelectEvents = { vstring SelectEvents={"*"} }
      }

	service = DaqMonitorROOTBackEnd{
               untracked int32 verbose = 0
        #   untracked string referenceFileName = "/data1/dropbox/"
        }
	
	service = MonitorDaemon{
	       #	 if true, will automatically start DQM thread in background
	       #  (default: false)
	       untracked bool AutoInstantiate = true

	       # if >=0, upon a connection problem, the source will automatically 
	       # attempt to reconnect with a time delay (secs) specified here 
	       # (default: 5)
	       untracked int32 reconnect_delay = 5
               # maximum # of reconnection attempts upon connection problems (default: 10)
               untracked int32 maxAttempts2Reconnect	= 99999

	       # collector hostname
       	       # (default: localhost)
               untracked string DestinationAddress = "srv-c2d05-19"

               # port for communicating with collector
               # (default: 9090)
               untracked int32 SendPort = 9090

               # monitoring period in ms (i.e. how often monitoring elements 
               # are shipped to the collector
               # (default: 1000)
               untracked int32 UpdateDelay = 10

               # name of DQM source
               # (default: DQMSource)
               untracked string NameAsSource = "Hcal"
	}

	service = DQMShipMonitoring{
		// event-period for shipping monitoring to collector (default: 25)
		untracked uint32 period = 25
	}

    #########################################################
    #### BEGIN DQM Online Environment #######################
    #########################################################
    # use include file for dqmEnv dqmSaver
       include "DQMServices/Components/test/dqm_onlineEnv.cfi"
       replace dqmSaver.fileName      = "Hcal"
       replace dqmSaver.dirName      = "/data1/dropbox"
       replace dqmEnv.subSystemFolder = "Hcal"
       
       # optionally change fileSaving  conditions
       // replace dqmSaver.prescaleLS =   -1
       // replace dqmSaver.prescaleTime = -1 # in minutes
       // replace dqmSaver.prescaleEvt =  -1
       // replace dqmSaver.saveAtRunEnd = true
       // replace dqmSaver.saveAtJobEnd = false
       # will add switch to select histograms to be saved soon
   
    #########################################################
    #### END ################################################
    #########################################################

}
